source ./setup.vim

Describe explorer
	Before all
		call BeforeAll()
	End


	"#-=- -=- -=- -=- -=- -=- -=- -=- -=-#"


	It BakaupExplore should be launch bakaup dir in new window current tab
		" {{{
		BakaupExplore

		let l:found_explorer = 0

		for l:w in tabpagebuflist()
			let l:bufname = bufname(l:w)
			if l:bufname ==# g:bakaup_backup_dir
				let l:found_explorer = 1
				break
			endif
		endfor

		Assert Equals(l:found_explorer, 1)
		" }}}
	End

	It BakaupTexplore should be launch bakaup dir in new tab out of current tab
		" {{{
		TODO 'could not test tabpages ?'

		let l:tabpagenr_before = tabpagenr()
		BakaupTexplore
		let l:tabpagenr_after  = tabpagenr()


		let l:found_explorer = 0
		for l:w in tabpagebuflist(l:tabpagenr_before)
			let l:bufname = bufname(l:w)
			if l:bufname ==# g:bakaup_backup_dir
				let l:found_explorer = 1
				break
			endif
		endfor
		Assert Equals(l:found_explorer, 0)


		let l:found_explorer = 0
		for l:w in tabpagebuflist(l:tabpagenr_after)
			let l:bufname = bufname(l:w)
			if l:bufname ==# g:bakaup_backup_dir
				let l:found_explorer = 1
				break
			endif
		endfor
		Assert Equals(l:found_explorer, 1)

		" }}}
	End

	It BakaupVexplore should be launch bakaup dir in new window current tab
		" {{{
		BakaupVexplore

		let l:found_explorer = 0
		let l:current_winnr  = winnr()

		for l:w in tabpagebuflist()
			if l:w is l:current_winnr
				continue
			endif

			let l:bufname = bufname(l:w)
			if l:bufname ==# g:bakaup_backup_dir
				let l:found_explorer = 1
				break
			endif
		endfor

		Assert Equals(l:found_explorer, 1)
		" }}}
	End

	It BakaupSexplore should be launch bakaup dir in new window current tab
		" {{{
		BakaupSexplore

		let l:found_explorer = 0
		let l:current_winnr  = winnr()

		for l:w in tabpagebuflist()
			if l:w is l:current_winnr
				continue
			endif

			let l:bufname = bufname(l:w)
			if l:bufname ==# g:bakaup_backup_dir
				let l:found_explorer = 1
				break
			endif
		endfor

		Assert Equals(l:found_explorer, 1)
		" }}}
	End
End
